{
  "master": {
    "tasks": [
      {
        "id": "1",
        "title": "Database schema expansion for Quick Dump queue and medical features",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      },
      {
        "id": "2",
        "title": "AI service integration layer",
        "status": "done",
        "dependencies": ["1"],
        "subtasks": []
      },
      {
        "id": "3",
        "title": "[ARCHIVED] AI-guided capture interface (v1)",
        "status": "done",
        "dependencies": [
          "2"
        ],
        "subtasks": []
      },
      {
        "id": "5",
        "title": "Zero-decision review interface (eliminate grading buttons)",
        "status": "done",
        "dependencies": ["1"],
        "subtasks": []
      },
      {
        "id": "10",
        "title": "Global search with <200ms response time",
        "status": "done",
        "dependencies": ["1"],
        "subtasks": []
      },
      {
        "id": "17",
        "title": "Auto-start Ollama from Electron on first AI request",
        "status": "done",
        "dependencies": ["2"],
        "subtasks": []
      },
      {
        "id": "31",
        "title": "BUG FIX: Quick Dump saves to notes table instead of quick_dumps table",
        "status": "done",
        "dependencies": [
          "1"
        ],
        "subtasks": []
      },
      {
        "id": "35",
        "title": "[v2-T1] Data model v3: SourceItem, CanonicalTopic, NotebookTopicPage, SmartView schemas",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "36",
        "title": "[v2-T1.1] Topic normalization: alias table, matching rules, dedupe prevention",
        "status": "done",
        "dependencies": ["35"],
        "subtasks": []
      },
      {
        "id": "38",
        "title": "[v2-T2] Capture pipeline: Quick Dump → SourceItem (inbox), text + image support",
        "status": "done",
        "dependencies": ["35"],
        "subtasks": []
      },
      {
        "id": "40",
        "title": "[v2-T3] Archive UI: vertical list grouped by status, search, filters",
        "status": "done",
        "dependencies": ["39"],
        "subtasks": []
      },
      {
        "id": "41",
        "title": "[v2-T4] Notebook UI: topic pages, add blocks from sources, enforce card-creation here only",
        "status": "done",
        "dependencies": ["40", "36"],
        "subtasks": []
      },
      {
        "id": "42",
        "title": "Card Generation from Notebook Blocks",
        "status": "done",
        "dependencies": ["41"],
        "subtasks": []
      },
      {
        "id": "44",
        "title": "[v2-T8] Smart Views: system views (Inbox, Today, Queue, Weak Topics), filter engine",
        "status": "done",
        "dependencies": ["35"],
        "subtasks": []
      },
      {
        "id": "45",
        "title": "[v2-T6] FSRS integration: scheduling fields, review UI, response time tracking",
        "status": "done",
        "dependencies": ["41", "42"],
        "subtasks": []
      },
      {
        "id": "91",
        "title": "Debug and Fix Ollama AI Extraction Pipeline",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "112",
        "title": "Sidebar Consolidation: merge SmartViewSidebar into Sidebar",
        "status": "done",
        "dependencies": ["44"],
        "subtasks": []
      },
      {
        "id": "113",
        "title": "Image Capture Support: paste, drop, display in KB/Notebook",
        "status": "cancelled",
        "dependencies": ["38", "41"],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.363Z"
      },
      {
        "id": "114",
        "title": "Backup/Restore UI: auto-save toast, Settings restore button",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "115",
        "title": "Card Browser: view all cards with filters (topic, status, due date)",
        "status": "done",
        "dependencies": ["42", "45"],
        "subtasks": []
      },
      {
        "id": "116",
        "title": "Browser Capture Hook: local HTTP API for Tampermonkey integration",
        "status": "cancelled",
        "dependencies": ["38"],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.443Z"
      },
      {
        "id": "117",
        "title": "Basic Learning Mode: post-review mistakes summary with elaborated feedback",
        "status": "done",
        "dependencies": ["45"],
        "subtasks": []
      },
      {
        "id": "118",
        "title": "Two-Mode Capture: FAB modal with auto-classification and Process Now button",
        "status": "done",
        "dependencies": ["38"],
        "subtasks": []
      },
      {
        "id": "119",
        "title": "Insight Writing Modal: Redesign Add to Notebook Flow",
        "status": "cancelled",
        "dependencies": ["118", "125"],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.519Z"
      },
      {
        "id": "120",
        "title": "NotebookBlock Schema Extension for AI Evaluation",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "121",
        "title": "AI Insight Evaluation Endpoint",
        "status": "done",
        "dependencies": [
          "120"
        ],
        "subtasks": []
      },
      {
        "id": "122",
        "title": "AI Feedback Panel in Insight Modal",
        "status": "done",
        "dependencies": [
          "119",
          "121"
        ],
        "subtasks": []
      },
      {
        "id": "123",
        "title": "Learning Tab Weak Points Panel",
        "status": "done",
        "dependencies": [
          "120",
          "122"
        ],
        "subtasks": []
      },
      {
        "id": "124",
        "title": "Tampermonkey Script Integration for Quick Capture",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "125",
        "title": "Data Logging Framework: Schema Extensions for Future AI",
        "status": "cancelled",
        "dependencies": ["118", "117"],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.587Z"
      },
      {
        "id": "126",
        "title": "v16 Migration: Create notebook_links Table",
        "status": "cancelled",
        "dependencies": [],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.661Z"
      },
      {
        "id": "127",
        "title": "Workflow 2 FIX: Prominent 'What did you learn?' Insight UI",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "128",
        "title": "Workflow 1: Quick Capture Completion",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "129",
        "title": "Step 2: Inbox Review - Polish",
        "description": "Polish the Inbox Review screen per canonical workflow. Row display: title, [Board Q] badge, excerpt, correctness indicator (✓/✗), relative time. Detail panel on click with [Add to Notebook] button. Batch actions: Archive (status='curated'), Delete (with confirm). See docs/Workflow_Guide.ini Step 2.",
        "details": "WORKFLOW 4: BROWSE INBOX COMPLETION\n\nSCREEN MOCKUP:\n```\n+-----------------------------------------------------------------------------+\n|  INBOX (23 items)                                                          |\n|                                                                             |\n|  [Search...]                    [Sort: Newest v]  [Filter: All Types v]    |\n|                                                                             |\n|  -------------------------------------------------------------------------  |\n|                                                                             |\n|  [ ] CKD G3 - CV Mortality                [Nephro] QBank check   2 hrs ago |\n|  [ ] Afib Rate Control vs Rhythm          [Cardio] QBank x       3 hrs ago |\n|  [ ] COPD Exacerbation Management         [Pulm]   QBank check   Yesterday |\n|  [ ] Diabetic Ketoacidosis Workup         [Endo]   QBank x       Yesterday |\n|  [ ] UpToDate: Heart Failure Guidelines   [Cardio] Article       2 days    |\n|  ...                                                                        |\n|                                                                             |\n|  -------------------------------------------------------------------------  |\n|                                                                             |\n|  With selected: [Add to Notebook] [Archive] [Delete]                       |\n|                                                                             |\n+-----------------------------------------------------------------------------+\n```\n\nCURRENT STATE:\n- List view works\n- Search works\n- Delete works\n\nMISSING/BROKEN:\n1. Archive uses DELETE instead of status='curated'\n2. Filter by sourceType not implemented\n3. Sort options not implemented\n4. Batch selection not implemented\n\nFLOW:\n1. User opens Inbox from sidebar\n2. Load items: sourceItemQueries.getByStatus('inbox')\n3. User can:\n   - Click item -> View source detail modal\n   - Select + [Add to Notebook] -> Workflow 2\n   - Select + [Archive] -> status = 'curated' (NOT delete)\n   - Select + [Delete] -> DELETE with confirmation\n4. Filters: by sourceType, domain (from metadata.subject)\n5. Sort: by createdAt (newest/oldest)\n\nDATABASE OPERATIONS:\n```typescript\n// List inbox\nconst items = await window.api.getSourceItemsByStatus('inbox');\n\n// Archive (mark as curated) - FIX THIS\nawait window.api.updateSourceItemStatus(id, 'curated');\n\n// Delete\nawait window.api.deleteSourceItem(id);\n```\n\nFILTERS TO ADD:\n- sourceType: qbank, article, pdf, image, quickcapture, manual, all\n- domain: from metadata.subject field, dynamically populated\n\nSORT OPTIONS:\n- Newest first (default)\n- Oldest first\n- By domain (alphabetical)\n- By type\n\nBATCH OPERATIONS:\n- Checkbox selection on each row\n- \"Select All\" checkbox in header\n- Batch actions: Add to Notebook (opens for first selected), Archive, Delete\n- Archive batch: no confirmation needed\n- Delete batch: \"Delete X items? This cannot be undone.\"\n\nEDGE CASES:\n\nEmpty inbox:\n- Show: \"Inbox empty! Capture some content to get started.\" [Capture]\n\nBatch actions on many items:\n- Archive: Update all, no confirmation needed\n- Delete: Confirm \"Delete X items? This cannot be undone.\"",
        "testStrategy": "Test Archive changes status to 'curated' not delete. Test archived items no longer appear in inbox. Test filter by sourceType works. Test sort by newest/oldest works. Test batch selection with Select All. Test batch archive updates all without confirmation. Test batch delete shows confirmation. Test empty inbox shows capture prompt.",
        "priority": "medium",
        "dependencies": [],
        "status": "pending",
        "subtasks": [],
        "updatedAt": "2026-01-12T21:00:00.000Z"
      },
      {
        "id": "130",
        "title": "Step 4: Notebook Topic Page - Polish",
        "description": "Polish the Notebook Topic Page per canonical workflow. Block cards show: title, source badge + correctness (✓/✗) + relative time, content (user insight), confusion note if present. Footer: card count + [Edit] [+ Card] [View Source]. See docs/Workflow_Guide.ini Step 4.",
        "details": "WORKFLOW 5: BROWSE NOTEBOOK COMPLETION\n\nSCREEN MOCKUP:\n```\n+-----------------------------------------------------------------------------+\n|  NOTEBOOK                                                [Search...]       |\n|                                                                             |\n|  +--------------+ +----------------------------------------------------+   |\n|  | DOMAINS      | |  Chronic Kidney Disease                   12 blocks|   |\n|  |              | |                                                    |   |\n|  | v Nephrology | |  +----------------------------------------------+ |   |\n|  |   - CKD (12) | |  | CKD - CV Mortality Risk            2hrs ago  | |   |\n|  |   - AKI (5)  | |  | [Cardio] [Mgmt] [Cross-Topic]                | |   |\n|  |   - GN (3)   | |  | \"CKD patients 4-5x more likely to die...\"    | |   |\n|  |              | |  | Links: 3  Source: 1  Cards: 0                | |   |\n|  | > Cardiology | |  +----------------------------------------------+ |   |\n|  | > Pulmonology| |                                                    |   |\n|  | > GI         | |  +----------------------------------------------+ |   |\n|  | > Endocrine  | |  | CKD Staging and GFR                2 days ago| |   |\n|  | ...          | |  | [Dx] [Boards-HY]                             | |   |\n|  |              | |  | \"Stage G3a: 45-59, G3b: 30-44...\"            | |   |\n|  | ------------ | |  | Links: 2  Source: 2  Cards: 1                | |   |\n|  | FILTERS:     | |  +----------------------------------------------+ |   |\n|  | [ ] Cross-Top| |                                                    |   |\n|  | [ ] Boards-HY| |  [+ Add Block]                                    |   |\n|  | [ ] No Cards | |                                                    |   |\n|  +--------------+ +----------------------------------------------------+   |\n|                                                                             |\n+-----------------------------------------------------------------------------+\n```\n\nCURRENT STATE:\n- Domain tree sidebar works\n- Topic selection works\n- Block list works\n\nMISSING:\n1. Cross-block search (search all blocks by content)\n2. Filters in sidebar: Cross-Topic, Boards-HY, No Cards\n3. Block counts in domain tree\n\nFLOW:\n1. User opens Notebook from sidebar\n2. Left sidebar: domains with nested topics\n   - Expand domain -> show topics with block counts\n3. Click topic -> load blocks for that topic's page\n4. Click block card -> Workflow 6 (Block Detail)\n5. Filters affect block list\n6. Search searches across ALL blocks (content field)\n\nDATABASE QUERIES:\n```typescript\n// Get domain tree with counts\nconst topics = await window.api.getAllCanonicalTopics();\n// Group by domain, count blocks per topic\n\n// Get blocks for topic\nconst page = await window.api.getNotebookTopicPageByTopic(topicId);\nconst blocks = await window.api.getNotebookBlocksByPage(page.id);\n\n// For each block, fetch source info\nfor (const block of blocks) {\n  block.source = await window.api.getSourceItem(block.sourceItemId);\n}\n\n// NEW: Search all blocks by content\nconst searchResults = await window.api.searchNotebookBlocks(query);\n// Returns blocks with topic name, content excerpt, match highlights\n```\n\nFILTERS (sidebar checkboxes):\n\n[ ] Cross-Topic:\n- Show only blocks where source has multiple canonicalTopicIds\n- OR blocks tagged with 'Cross-Topic'\n\n[ ] Boards-HY:\n- Show only blocks tagged with 'Boards-HY' or 'High-Yield'\n\n[ ] No Cards:\n- Show only blocks where cardCount = 0\n- Helps identify content not yet converted to cards\n\nSEARCH:\n- Search box in header searches ALL notebook blocks\n- Searches block.content field\n- Returns results grouped by topic\n- Click result -> navigate to that topic and highlight block\n\nIPC TO ADD:\n```typescript\n// Search notebook blocks by content\nwindow.api.searchNotebookBlocks(query: string): Promise<Array<{\n  block: DbNotebookBlock;\n  topicName: string;\n  excerpt: string;  // Content snippet with match\n}>>\n```\n\nUI UPDATES:\n- Add search input in notebook header\n- Add filter checkboxes in sidebar below domain tree\n- Add block count badges next to each topic in tree\n- Search results appear in main area, replacing topic view temporarily",
        "testStrategy": "Test cross-block search finds blocks by content. Test search results show topic name and excerpt. Test clicking search result navigates to topic. Test Cross-Topic filter shows multi-topic blocks. Test Boards-HY filter shows tagged blocks. Test No Cards filter shows blocks with cardCount=0. Test block counts appear in domain tree. Test filters can be combined.",
        "priority": "medium",
        "dependencies": [],
        "status": "pending",
        "subtasks": [],
        "updatedAt": "2026-01-12T21:00:00.000Z"
      },
      {
        "id": "131",
        "title": "Workflow 7: Edit Block",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "132",
        "title": "Workflow 8: Add Source to Another Topic",
        "status": "cancelled",
        "dependencies": ["126"],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.742Z"
      },
      {
        "id": "133",
        "title": "Workflow 9: Add Manual Link",
        "status": "done",
        "dependencies": [
          "126"
        ],
        "subtasks": []
      },
      {
        "id": "134",
        "title": "Workflow 10: Remove Link",
        "status": "done",
        "dependencies": [
          "126",
          "133"
        ],
        "subtasks": []
      },
      {
        "id": "135",
        "title": "Workflow 6 Enhancement: Links Sidebar with Hover-Highlight",
        "status": "cancelled",
        "dependencies": ["126", "133", "134"],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.817Z"
      },
      {
        "id": "136",
        "title": "Workflow 13: Edit Card - Add Reset Progress Button",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "137",
        "title": "Workflow 3: AI Backlink Detection (Async)",
        "priority": "medium",
        "dependencies": ["126", "127"],
        "status": "cancelled",
        "subtasks": [],
        "updatedAt": "2026-01-24T01:59:56.187Z"
      },
      {
        "id": "138",
        "title": "Step 3: Add to Notebook + Board Relevance Panel",
        "description": "Implement the Add to Notebook modal per canonical workflow. Shows: source preview, topic dropdown, Board Relevance Panel (accuracy stats, concepts tested, what you missed), AI-suggested concepts with checkboxes, optional notes field. See docs/Workflow_Guide.ini Step 3.",
        "details": "STEP 3: ADD TO NOTEBOOK + BOARD RELEVANCE\n\nTrigger: Click 'Add to Notebook' from detail panel\n\nUI SECTIONS:\n1. Source preview (collapsed): title, type badge, correctness\n2. Topic dropdown + [+ Create New]\n3. Board Relevance Panel:\n   - Questions attempted for this topic\n   - Accuracy (X/Y correct)\n   - Concepts commonly tested (from testedConcepts aggregation)\n   - What you missed (incorrect items for this topic)\n   - AI suggestion on focus area\n4. Key Concepts checkboxes (AI-extracted from source)\n5. Notes field (optional, for confusion notes)\n\nDATA REQUIRED:\n- getBoardRelevanceForTopic(topicIds) already exists in source-items.ts\n- Returns: total, correct, incorrect, testedConcepts aggregation\n\nNEW IPC NEEDED:\n- Expose getBoardRelevanceForTopic via window.api\n\nUI COMPONENT:\n- Enhance AddToNotebookWorkflow.tsx or create new AddToNotebookModal.tsx\n- Board Relevance Panel as collapsible section\n- Concept checkboxes from AI extraction (may already exist)\n\nSAVE BEHAVIOR:\n- Create NotebookBlock with selected concepts + notes as content\n- Update source status to 'processed'",
        "testStrategy": "Test Board Relevance Panel shows correct stats for selected topic. Test accuracy calculation is correct. Test concepts tested list populates from testedConcepts. Test 'what you missed' shows incorrect items. Test concept checkboxes toggle correctly. Test notes field saves to block. Test topic change refreshes relevance panel.",
        "priority": "high",
        "dependencies": [],
        "status": "pending",
        "subtasks": [],
        "updatedAt": "2026-01-24T02:00:00.000Z"
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2026-01-24T02:47:41.817Z",
      "taskCount": 43,
      "completedCount": 32,
      "tags": ["master"]
    }
  }
}