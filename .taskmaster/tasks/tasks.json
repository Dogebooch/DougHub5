{
  "master": {
    "tasks": [
      {
        "id": 1,
        "title": "Database schema expansion for Quick Dump queue and medical features",
        "description": "Add quick_dumps table and extend cards/notes tables to support medical list processing, partial credit, response time tracking, and connection suggestions",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create quick_dumps table schema and migration logic",
            "description": "Add quick_dumps table to database.ts with proper schema, types, and version migration from user_version=1 to user_version=2",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Extend cards table with medical feature columns",
            "description": "Add cardType, parentListId, and listPosition columns to cards table through schema migration",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Extend review_logs table with performance tracking columns",
            "description": "Add responseTimeMs and partialCreditScore columns to review_logs table for tracking review performance metrics",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Create connections table for semantic note relationships",
            "description": "Add connections table to store semantic relationships between notes with similarity scores",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Implement query functions and IPC handlers for new tables",
            "description": "Create quickDumpQueries and connectionQueries objects, add corresponding IPC handlers in ipc-handlers.ts, and expose via preload.ts",
            "dependencies": [
              1,
              2,
              3,
              4
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2026-01-05T00:05:06.017Z"
      },
      {
        "id": 2,
        "title": "AI service integration layer",
        "description": "Create local-first AI service with Ollama auto-detection, cloud fallbacks (OpenAI, DeepSeek, Anthropic), concept extraction, card format suggestions, and medical content processing",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [
          "1"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create AI provider abstraction and type definitions",
            "description": "Set up local-first provider detection, OpenAI-compatible SDK configuration, and all AI-related types",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T01:12:15.700Z"
          },
          {
            "id": 2,
            "title": "Implement concept extraction and card validation functions",
            "description": "Build extractConcepts and validateCard functions with provider-aware timeout and retry logic",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T01:15:33.268Z"
          },
          {
            "id": 3,
            "title": "Implement medical list detection and vignette conversion",
            "description": "Create functions to detect medical lists and convert list items to clinical vignettes",
            "dependencies": [
              1,
              2
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T01:17:15.711Z"
          },
          {
            "id": 4,
            "title": "Implement tag suggestions and semantic similarity search",
            "description": "Build AI-powered tag suggestion and note similarity matching functions",
            "dependencies": [
              1,
              2
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T01:19:43.555Z"
          },
          {
            "id": 5,
            "title": "Add caching layer and IPC handlers for AI service",
            "description": "Implement 5-minute result caching, provider status, and integrate AI service with IPC layer",
            "dependencies": [
              2,
              3,
              4
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T01:22:53.351Z"
          }
        ],
        "updatedAt": "2026-01-05T01:22:53.351Z"
      },
      {
        "id": 3,
        "title": "AI-guided capture interface",
        "description": "Replace manual capture interface with AI concept extraction workflow: paste → highlight → confirm → format suggestion → save",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [
          "2"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Add paste detection and content state management",
            "description": "Implement paste area UI with auto-detection and state management for pasted content, extracted concepts, selected concepts, and processing state",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T14:29:44.663Z"
          },
          {
            "id": 2,
            "title": "Create concept extraction display with checkboxes",
            "description": "Build ConceptCheckbox component to display extracted concepts with selection, format badges, and edit capability",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T14:29:44.666Z"
          },
          {
            "id": 3,
            "title": "Implement AI concept extraction integration",
            "description": "Wire up AI service calls for concept extraction with loading states and error handling",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T14:29:44.669Z"
          },
          {
            "id": 4,
            "title": "Add format suggestion display and validation warnings",
            "description": "Create ValidationWarning component and integrate real-time card validation for each selected concept",
            "dependencies": [
              2,
              3
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T14:29:44.671Z"
          },
          {
            "id": 5,
            "title": "Implement batch card creation and auto-note generation",
            "description": "Create batch card creation flow with auto-generated parent Note and save feedback within 500ms",
            "dependencies": [
              2,
              3,
              4
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-05T14:29:44.672Z"
          }
        ],
        "updatedAt": "2026-01-05T14:29:44.672Z"
      },
      {
        "id": 5,
        "title": "Zero-decision review interface (eliminate grading buttons)",
        "description": "Replace 4-button grading (Again/Hard/Good/Easy) with Show Answer → Continue flow, letting FSRS auto-schedule based on response time",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [
          "1"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Remove grading buttons and interval preview UI",
            "description": "Remove the 4-button grading interface (Again/Hard/Good/Easy) and interval previews from ReviewInterface.tsx",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T00:32:13.586Z"
          },
          {
            "id": 2,
            "title": "Implement Show Answer → Continue flow with response time tracking",
            "description": "Replace grading buttons with single Continue button and add response time tracking from card shown to Continue pressed",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T00:32:13.591Z"
          },
          {
            "id": 3,
            "title": "Implement auto-rating algorithm based on response time",
            "description": "Create algorithm to automatically determine Rating based on response time: <5s=Easy, 5-15s=Good, 15-30s=Hard, >30s=Again",
            "dependencies": [
              2
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T00:32:13.595Z"
          },
          {
            "id": 4,
            "title": "Update scheduleReview to accept and store responseTimeMs",
            "description": "Modify scheduleReview function and review_logs table to accept and persist response time in milliseconds",
            "dependencies": [
              3
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T00:32:13.598Z"
          },
          {
            "id": 5,
            "title": "UI cleanup and zero-decision interface verification",
            "description": "Clean up UI after removing grading buttons, verify progress bar and session stats work, ensure FSRS performance <100ms",
            "dependencies": [
              4
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T00:32:13.600Z"
          },
          {
            "id": 6,
            "title": "Auto-grade animation feedback display",
            "description": "Show brief visual feedback of the auto-determined grade (Easy/Good/Hard/Again) for ~1 second after Continue pressed, before advancing to next card",
            "dependencies": [
              5
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T00:32:13.603Z"
          },
          {
            "id": 7,
            "title": "Quick override mechanism during feedback display",
            "description": "Allow user to override auto-grade during the 1-second feedback window using keyboard shortcuts (1-4) or clicking alternative grades",
            "dependencies": [
              6
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T00:32:13.607Z"
          }
        ],
        "updatedAt": "2026-01-06T00:32:13.607Z"
      },
      {
        "id": 10,
        "title": "Global search with <200ms response time",
        "description": "Implement fast unified search across cards and notes with FTS5 full-text search, Cmd+F shortcut, instant results",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [
          "1"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create FTS5 virtual tables for cards, notes, and source_items with sync triggers",
            "description": "Implement FTS5 full-text search tables with automatic synchronization triggers for all searchable content",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Implement searchQueries.search() with filter support and performance tracking",
            "description": "Create unified search function that queries all FTS tables with filter options (all/cards/notes/inbox) and tracks response time",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Add IPC handler, preload exposure, and TypeScript types for search",
            "description": "Wire up search functionality through IPC layer with proper type definitions",
            "dependencies": [
              2
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Build basic SearchBar component with debounced query and results dropdown",
            "description": "Replace placeholder SearchBar with functional component that performs real-time search with debounced input and displays top 10 results in dropdown",
            "dependencies": [
              3
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Add horizontal filter chips UI with toggleable selection and count badges",
            "description": "Implement filter chip buttons (All/Cards/Notes/Inbox) above search results with active state and result counts",
            "dependencies": [
              4
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 6,
            "title": "Implement keyboard navigation and Ctrl+F global shortcut",
            "description": "Add full keyboard support for search including Up/Down/Enter/Escape navigation and global Ctrl+F hotkey to focus search bar",
            "dependencies": [
              5
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 7,
            "title": "Add search term highlighting in result snippets",
            "description": "Implement visual highlighting of matched search terms in result text using FTS5 snippet() function",
            "dependencies": [
              4
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 8,
            "title": "Create full SearchResults page component with sections and view-all navigation",
            "description": "Build dedicated full-page search results view with categorized sections, showing all matches beyond the 10-result dropdown limit",
            "dependencies": [
              7
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2026-01-06T05:12:32.737Z"
      },
      {
        "id": 17,
        "title": "Auto-start Ollama from Electron on first AI request",
        "description": "Automatically start Ollama when the app needs AI services, eliminating the friction of manually starting Ollama before using the app",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [
          "2"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Implement ensureOllamaRunning() function with process spawning",
            "description": "Create function to check Ollama status and spawn it if not running",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Integrate auto-start into AI client initialization",
            "description": "Update initializeClient() to call ensureOllamaRunning() when Ollama provider is detected",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Add user notification for Ollama status via IPC",
            "description": "Notify renderer process about Ollama auto-start status so user sees feedback",
            "dependencies": [
              2
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Handle cross-platform Ollama executable detection",
            "description": "Ensure Ollama can be found and started on Windows, macOS, and Linux",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2026-01-06T05:29:32.390Z"
      },
      {
        "id": 31,
        "title": "BUG FIX: Quick Dump saves to notes table instead of quick_dumps table",
        "description": "QuickDumpModal incorrectly saves content as a regular note instead of to the quick_dumps table, breaking the extraction queue workflow",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [
          "1"
        ],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-06T02:11:06.148Z"
      },
      {
        "id": 35,
        "title": "[v2-T1] Data model v3: SourceItem, CanonicalTopic, NotebookTopicPage, SmartView schemas",
        "description": "Implement the v2 architecture data model with new tables for 3-layer system: Knowledge Bank (SourceItem), Notebook (NotebookTopicPage, NotebookBlock), and enhanced Cards with provenance. Add CanonicalTopic for topic normalization and SmartView for filtered access.",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Define TypeScript interfaces for v3 data model",
            "description": "Create TypeScript interfaces in src/types/index.ts for SourceItem, CanonicalTopic, NotebookTopicPage, NotebookBlock, SmartView, and SmartViewFilter. Update Card interface with optional provenance fields.",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Create database schema v3 with migration from v2",
            "description": "Implement new tables (source_items, canonical_topics, notebook_topic_pages, notebook_blocks, smart_views) in electron/database.ts with migration from schema v2 to v3.",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Implement CRUD functions for new tables",
            "description": "Add database query functions for SourceItem, NotebookTopicPage, NotebookBlock, CanonicalTopic, and SmartView in electron/database.ts following existing pattern.",
            "dependencies": [
              2
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Wire IPC handlers for new CRUD operations",
            "description": "Register IPC handlers in ipc-handlers.ts, expose via preload.ts, and declare types in electron.d.ts for all new database operations.",
            "dependencies": [
              3
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Update test helpers with new schema",
            "description": "Add new table creation to tests/helpers/db-helpers.ts ensuring test database schema matches production v3 schema.",
            "dependencies": [
              2
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          }
        ]
      },
      {
        "id": 36,
        "title": "[v2-T1.1] Topic normalization: alias table, matching rules, dedupe prevention",
        "description": "Implement topic alias matching system that normalizes user input to canonical topics. 'HOCM', 'HCM', 'hypertrophic cardiomyopathy' should all resolve to the same CanonicalTopic.",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [
          "35"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create electron/topic-service.ts with core alias resolution functions",
            "description": "Implement resolveTopicAlias() and createOrGetTopic() functions for basic topic alias lookup and creation with automatic alias generation",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "updatedAt": "2026-01-06T14:43:34.428Z",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Implement suggestTopicMatches() with fuzzy search for autocomplete",
            "description": "Add fuzzy search function to suggest topic matches using simple string similarity for autocomplete dropdown",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T14:54:58.758Z"
          },
          {
            "id": 3,
            "title": "Implement addTopicAlias() with uniqueness validation",
            "description": "Add function to add new aliases to existing topics with duplicate prevention across all topics",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T15:05:57.395Z"
          },
          {
            "id": 4,
            "title": "Implement mergeTopics() with transactional safety and reference updates",
            "description": "Add topic merging function that consolidates aliases and updates all references in source_items and notebook_topic_pages tables",
            "dependencies": [
              1,
              3
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T15:37:46.360Z"
          },
          {
            "id": 5,
            "title": "Wire IPC handlers and create TopicAutocomplete UI component",
            "description": "Register IPC handlers for topic operations and build React autocomplete component with debounced search and dropdown suggestions",
            "dependencies": [
              1,
              2,
              3,
              4
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T15:44:32.497Z"
          }
        ],
        "updatedAt": "2026-01-06T15:44:32.497Z"
      },
      {
        "id": 38,
        "title": "[v2-T2] Capture pipeline: Quick Dump → SourceItem (inbox), text + image support",
        "description": "Implement capture flow that creates SourceItems in Knowledge Bank with inbox status. Support text paste and image paste/drop.",
        "details": "TEXT CAPTURE: Complete ✓. IMAGE CAPTURE: NOT IMPLEMENTED (T38.2-T38.3 pending). Database supports images but UI lacks handlers.",
        "testStrategy": "Test text capture (working), test image capture (pending)",
        "priority": "high",
        "dependencies": [
          "35"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Update QuickDumpModal to create SourceItems instead of QuickDumps",
            "description": "Refactor QuickDumpModal.tsx to use sourceItems.create API, mapping text content to SourceItem schema with sourceType='quickcapture' and status='inbox'.",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T02:38:03.709Z"
          },
          {
            "id": 2,
            "title": "Add image paste/drop support to QuickDumpModal",
            "description": "Implement clipboard paste and drag-drop handlers for images in QuickDumpModal, with visual preview and content type detection.",
            "dependencies": [
              1
            ],
            "details": "CRITICAL: NOT IMPLEMENTED. T38.2 was marked DONE incorrectly. QuickDumpModal only handles text paste (clipboardData.getData('text')). No image handlers exist for clipboardData.files or clipboardData.items. Database schema supports images (imageData BLOB) but UI does not.",
            "status": "cancelled",
            "testStrategy": "Test image paste from clipboard, drag-drop image files, verify preview displays, confirm imageData saves to DB",
            "parentId": "undefined",
            "updatedAt": "2026-01-07T00:32:52.755Z"
          },
          {
            "id": 3,
            "title": "Implement image file storage and mediaPath handling",
            "description": "Create IPC handler for saving image files to app data directory and returning relative path for mediaPath field.",
            "dependencies": [
              2
            ],
            "details": "Depends on T38.2. No IPC handlers exist for image save operations. Need: saveImage(buffer) IPC handler, file storage in app.getPath('userData')/images/, return mediaPath for DB storage.",
            "status": "cancelled",
            "testStrategy": "Save image via IPC, verify file exists in userData/images/, confirm mediaPath stored in sourceItems table, test image retrieval",
            "parentId": "undefined",
            "updatedAt": "2026-01-07T00:32:52.758Z"
          },
          {
            "id": 4,
            "title": "Add inboxCount state management to useAppStore",
            "description": "Extend useAppStore with inboxCount state that queries source_items table for items with status='inbox', and refreshes after captures.",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "updatedAt": "2026-01-06T02:33:30.360Z",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Wire Sidebar to display inbox badge count from useAppStore",
            "description": "Connect Sidebar component to useAppStore.inboxCount and replace hardcoded inboxCount=0 with live state.",
            "dependencies": [
              4
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T02:33:30.460Z"
          }
        ],
        "updatedAt": "2026-01-07T00:32:56.159Z"
      },
      {
        "id": 40,
        "title": "[v2-T3] Knowledge Bank UI: vertical list grouped by status, search, filters",
        "description": "Build the main Knowledge Bank view showing all SourceItems organized by status with filtering and search capabilities.",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [
          "39"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create StatusGroup collapsible component (COMPLETE)",
            "description": "StatusGroup.tsx component is already complete with collapsible status sections, badge styling, and chevron animations.",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Create KnowledgeBankView with status-grouped layout",
            "description": "Build main Knowledge Bank view component fetching all SourceItems and organizing them into 3 collapsible StatusGroup sections (Inbox, Processed, Curated) using existing row components.",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "updatedAt": "2026-01-06T20:44:26.020Z",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Add search and filter controls to KnowledgeBankView",
            "description": "Implement real-time search input (debounced 200ms) and multi-select filters (status, source type) with AND logic to filter visible items in Knowledge Bank.",
            "dependencies": [
              2
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T20:57:59.367Z"
          }
        ],
        "updatedAt": "2026-01-06T20:57:59.367Z"
      },
      {
        "id": 41,
        "title": "[v2-T4] Notebook UI: topic pages, add blocks from sources, enforce card-creation here only",
        "description": "Build the Notebook layer with topic pages containing blocks from Knowledge Bank. This is the ONLY place where cards can be created.",
        "details": "NOTEBOOK VIEW:\n\n1. TOPIC PAGE LIST:\n- Sidebar or list showing all NotebookTopicPages\n- Show: topic name, aliases, card count, source count\n- Search/filter by topic name\n- 'New Topic Page' button\n\n2. TOPIC PAGE VIEW:\n- Header: Topic name, aliases, stats\n- Blocks section: excerpts from SourceItems\n- Each block shows:\n  - Source reference (clickable deep link)\n  - Content excerpt\n  - Annotations (user notes)\n  - Actions: [Edit] [→ Source] [Generate Card]\n- Footer: [+ Add from Knowledge Bank] [Generate All Cards]\n\n3. ADD BLOCK FLOW:\n- Click '+ Add from Knowledge Bank'\n- Modal shows Knowledge Bank filtered to curated/processed\n- Select source item\n- Select excerpt (highlight text) or use full content\n- Save creates NotebookBlock linked to source\n- SourceItem status → 'curated'\n\n4. BLOCK MANAGEMENT:\n- Drag to reorder blocks (position field)\n- Edit block content (excerpt)\n- Add annotations\n- Delete block (doesn't delete source)\n\nCARD CREATION ENFORCED:\n- 'Generate Card' button ONLY appears on blocks\n- No card creation in Knowledge Bank\n- No card creation from scratch\n- All cards have notebookTopicPageId (enforced)\n\nCOMPONENTS:\n\n- src/components/notebook/NotebookView.tsx\n- src/components/notebook/TopicPageList.tsx\n- src/components/notebook/TopicPageView.tsx\n- src/components/notebook/NotebookBlock.tsx\n- src/components/notebook/AddBlockModal.tsx",
        "testStrategy": "Create topic page, add block from source, verify deep link works. Generate card from block, verify card has notebookTopicPageId. Verify no way to create card outside Notebook.",
        "priority": "high",
        "dependencies": [
          "40",
          "36"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Create NotebookView container component with routing integration",
            "description": "Build the main NotebookView container that renders when currentView is 'notebook', replacing the placeholder in AppLayout.tsx",
            "dependencies": [],
            "details": "Create src/components/notebook/NotebookView.tsx as the main container. Add state management for loading topic pages and blocks. Integrate with useAppStore to handle currentView='notebook'. Import and render TopicPageList and TopicPageView as child components. Set up responsive layout with sidebar (TopicPageList) and main content area (TopicPageView). Follow the pattern established in KnowledgeBankView.tsx for loading states, error handling, and IPC calls to window.api.notebookPages.getAll(). Add to AppLayout.tsx renderView switch case.",
            "status": "pending",
            "testStrategy": "Navigate to notebook view from sidebar, verify component renders without errors, check that it fetches topic pages on mount"
          },
          {
            "id": 2,
            "title": "Build TopicPageList sidebar with search and new topic creation",
            "description": "Create the topic page list sidebar showing all NotebookTopicPages with search/filter and 'New Topic Page' button",
            "dependencies": [
              1
            ],
            "details": "Create src/components/notebook/TopicPageList.tsx. Display list of NotebookTopicPages with topic name (via canonicalTopicId lookup using window.api.canonicalTopics.getById), card count (cardIds.length), and derived source count. Implement search/filter input to filter by topic name using local state. Add 'New Topic Page' button that opens a dialog using shadcn Dialog component with topic autocomplete (similar to AddToNotebookDialog pattern with window.api.canonicalTopics.suggestMatches). On topic selection/creation, call window.api.notebookPages.create() with new NotebookTopicPage object (UUID id, canonicalTopicId, empty cardIds array, timestamps). Display active/selected topic page with visual indicator. Handle empty state when no topics exist.",
            "status": "pending",
            "testStrategy": "Click 'New Topic Page', create new topic, verify it appears in list. Search for topics, verify filtering works. Click topic to select it."
          },
          {
            "id": 3,
            "title": "Build TopicPageView with header, stats, and blocks list",
            "description": "Create the main topic page view showing header with topic info, stats, and list of NotebookBlocks",
            "dependencies": [
              1
            ],
            "details": "Create src/components/notebook/TopicPageView.tsx. Accept selectedPageId prop from NotebookView. Fetch topic page using window.api.notebookPages.getById(selectedPageId) and blocks using window.api.notebookBlocks.getByPage(selectedPageId). Fetch CanonicalTopic details using window.api.canonicalTopics.getById(page.canonicalTopicId) to display topic name and aliases. Header section displays topic name, aliases (as badges), card count, and source count (derived from blocks). Blocks section maps over NotebookBlock[] and renders NotebookBlock component for each. Footer with '+ Add from Knowledge Bank' button (will open AddBlockModal) and 'Generate All Cards' placeholder button (disabled with tooltip 'Coming in T42'). Handle loading states and empty blocks state with helpful message. Sort blocks by position field ascending.",
            "status": "pending",
            "testStrategy": "Select topic page, verify header shows correct topic name and stats. Verify blocks list renders. Click footer buttons to verify behavior."
          },
          {
            "id": 4,
            "title": "Create NotebookBlock component with source deep link and actions",
            "description": "Build the individual block component displaying source excerpt, annotations, and action buttons",
            "dependencies": [
              3
            ],
            "details": "Create src/components/notebook/NotebookBlock.tsx accepting NotebookBlock as prop. Use shadcn Card component for container with hover effects. Fetch SourceItem details using window.api.sourceItems.getById(block.sourceItemId) to display source reference. Display source reference as clickable link that calls useAppStore.setCurrentView('knowledgebank', block.sourceItemId) to navigate to Knowledge Bank with item highlighted. Show block content (full content, not excerpt per scope). If block.annotations exists, display in muted text below content. If block.mediaPath exists, display image preview. Actions row with [Edit] button (opens inline textarea to edit block.content and block.annotations, saves via window.api.notebookBlocks.update), [→ Source] button (same as clicking source reference), and [Generate Card] placeholder button (disabled with tooltip 'Coming in T42'). Delete button in dropdown menu calls window.api.notebookBlocks.delete(block.id).",
            "status": "pending",
            "testStrategy": "Verify block displays source reference correctly. Click source deep link, verify navigation to Knowledge Bank. Edit block content and annotations, verify saves. Click Generate Card placeholder, verify tooltip shows."
          },
          {
            "id": 5,
            "title": "Build AddBlockModal for selecting sources from Knowledge Bank",
            "description": "Create modal dialog for adding blocks from Knowledge Bank SourceItems to current topic page",
            "dependencies": [
              3
            ],
            "details": "Create src/components/notebook/AddBlockModal.tsx using shadcn Dialog. Accept props: open, onOpenChange, notebookTopicPageId, onSuccess. Fetch SourceItems filtered by status='processed' or status='curated' (exclude inbox per spec) using window.api.sourceItems.getAll() then filter locally. Display vertical list similar to KnowledgeBankView with SourceItemRow-like cards showing title, source type badge, topic tags. Add search/filter input to filter by title or tags. On item selection, create NotebookBlock: fetch existing blocks for page to determine max position, create block with UUID id, notebookTopicPageId, sourceItemId, content=sourceItem.rawContent (full content per scope), annotations=null, mediaPath=sourceItem.mediaPath, position=maxPosition+1. Call window.api.notebookBlocks.create(block). Update SourceItem status to 'curated' via window.api.sourceItems.update(id, {status: 'curated'}). Show success toast and trigger onSuccess callback to refresh parent.",
            "status": "pending",
            "testStrategy": "Open AddBlockModal from topic page footer. Search for sources, verify filtering. Select source item, verify block is created and appears in blocks list. Verify source status updated to curated."
          },
          {
            "id": 6,
            "title": "Wire up Notebook view navigation and integrate with app routing",
            "description": "Connect Notebook view to sidebar navigation and ensure proper state management integration",
            "dependencies": [
              2,
              3,
              4,
              5
            ],
            "details": "Update AppLayout.tsx to import and render NotebookView component instead of placeholder when currentView='notebook'. Ensure SmartViewSidebar.tsx or Sidebar.tsx has proper navigation to notebook view using useAppStore.setCurrentView('notebook'). Add notebook count to smartViewCounts in useAppStore.ts by fetching window.api.notebookPages.getAll() and counting total pages. Update refreshSmartViewCounts to include notebook count. Test navigation flow: Knowledge Bank → Add to Notebook → View in Notebook should work seamlessly. Ensure selectedItemId from store is used to highlight/scroll to specific item when navigating from deep links. Add loading and error states for all async operations. Verify IpcResult error handling follows established patterns.",
            "status": "pending",
            "testStrategy": "Navigate to notebook from sidebar, verify correct view loads. Add source to notebook from Knowledge Bank, click 'View in Notebook' link, verify navigation and item highlight. Check notebook count badge in sidebar updates correctly."
          }
        ]
      },
      {
        "id": 42,
        "title": "[v2-T4.1] Card generation from notebook: AI suggests, card-worthiness gate",
        "description": "Implement AI-powered card generation from Notebook blocks with card-worthiness evaluation before creation.",
        "details": "CARD GENERATION FLOW:\n\n1. USER INITIATES:\n- Click 'Generate Card' on a block\n- Or 'Generate All Cards' for entire topic page\n\n2. AI CARD SUGGESTION:\n- Call AI to analyze block content\n- Suggest card format (Q&A, cloze, vignette)\n- Generate front/back content\n- Return multiple card suggestions if content-rich\n\n3. CARD-WORTHINESS GATE (T5):\n- Before showing card to user, evaluate:\n  - Board-relevant? (high-yield for Step 2/3)\n  - Testable? (clear right answer)\n  - Discriminative? (distinguishes from similar concepts)\n- Show AI assessment with checkmarks/warnings\n- Recommendation: CREATE CARD / KEEP AS NOTE ONLY\n\n4. USER DECISION:\n- [Create Card] - proceeds with creation\n- [Keep as Note Only] - doesn't create card, marks block\n- [Edit First] - allows editing before creation\n- [Discard] - cancels without saving\n\n5. CARD CREATION:\n- Create card with:\n  - notebookTopicPageId (required)\n  - sourceBlockId (specific block)\n  - tags from topic\n  - FSRS defaults\n- Update NotebookTopicPage.cardIds array\n\nCOMPONENTS:\n\n- src/components/notebook/CardGenerationModal.tsx\n- src/components/notebook/CardWorthinessGate.tsx\n- src/components/notebook/CardSuggestionPreview.tsx\n\nAI FUNCTIONS in electron/ai-service.ts:\n- generateCardFromBlock(blockContent: string, topicContext: string): Promise<CardSuggestion[]>\n- evaluateCardWorthiness(card: CardSuggestion): Promise<WorthinessAssessment>",
        "testStrategy": "Generate card from medical fact block, verify AI suggests appropriate format. Test worthiness gate shows correct assessments. Test 'Keep as Note Only' doesn't create card. Verify all created cards have required provenance fields.",
        "priority": "high",
        "dependencies": [
          "41"
        ],
        "status": "pending",
        "subtasks": []
      },
      {
        "id": 43,
        "title": "[v2-T5] Card-worthiness gate: rubric (board-relevant? testable? discriminative?), UI",
        "description": "Implement the full card-worthiness evaluation rubric that gates all card creation to minimize low-yield cards.",
        "details": "WORTHINESS RUBRIC:\n\n1. BOARD-RELEVANT:\n- Is this high-yield for Step 2/3 or specialty boards?\n- AI checks against known high-yield topics\n- Weight: High\n\n2. TESTABLE:\n- Does this have a clear, unambiguous answer?\n- Avoid opinion-based or 'it depends' content\n- Weight: High\n\n3. DISCRIMINATIVE:\n- Does this distinguish from similar concepts?\n- Avoid cards that could apply to multiple conditions\n- Weight: Medium\n\n4. MINIMUM INFORMATION:\n- Single concept per card?\n- Not testing multiple facts at once?\n- Weight: High\n\n5. NO PATTERN MATCHING:\n- Answer not giveaway from card format?\n- Could be rephrased and still work?\n- Weight: Medium\n\nSCORING:\n- Each criterion: Pass / Warning / Fail\n- Overall: CREATE / CONSIDER EDITING / NOT RECOMMENDED\n- Show reasoning for each criterion\n\nUI COMPONENT:\n\n```\n┌─ Card Quality Check ─────────────────────────────────┐\n│ \"What is the most specific marker for MI?\"           │\n│ → Troponin I                                         │\n│                                                      │\n│ ✓ Board-relevant (high-yield for Step 2/3)           │\n│ ✓ Testable (clear right answer)                      │\n│ ✓ Discriminative (distinguishes troponin vs CK-MB)   │\n│ ✓ Minimum information (single fact)                  │\n│ ⚠️ Consider: Add 'why' for deeper learning           │\n│                                                      │\n│ Recommendation: ✅ CREATE CARD                       │\n│                                                      │\n│ [Create] [Keep Note] [Edit] [Discard]                │\n└──────────────────────────────────────────────────────┘\n```\n\nAI IMPLEMENTATION:\n- evaluateCardWorthiness(card) returns WorthinessAssessment\n- WorthinessAssessment has criteria[], overallRecommendation, suggestions[]",
        "testStrategy": "Test high-yield card passes all criteria. Test vague card gets warnings. Test multi-fact card fails minimum info. Test pattern-matching card gets warning. Verify recommendations match rubric logic.",
        "priority": "high",
        "dependencies": [
          "42"
        ],
        "status": "pending",
        "subtasks": []
      },
      {
        "id": 44,
        "title": "[v2-T8] Smart Views: system views (Inbox, Today, Queue, Weak Topics), filter engine",
        "description": "Implement Smart Views system with preset system views and a reusable filter engine for dynamic list filtering.",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [
          "35"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create filter engine types and applyFilter() function",
            "description": "Implement reusable filter engine with SmartViewFilter interface and applyFilter() function in new src/lib/filter-engine.ts file.",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T20:57:59.462Z"
          },
          {
            "id": 2,
            "title": "Define system view configurations (Inbox, Today, Queue, Weak Topics)",
            "description": "Create system view definitions with filter configs, icons, and sort rules in src/lib/system-views.ts using SmartView type.",
            "dependencies": [
              1
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T21:12:10.382Z"
          },
          {
            "id": 3,
            "title": "Build SmartViewSidebar component with view list UI",
            "description": "Create SmartViewSidebar component in src/components/layout/SmartViewSidebar.tsx displaying system views with icons, badges, and click handlers.",
            "dependencies": [],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T20:57:59.558Z"
          },
          {
            "id": 4,
            "title": "Implement badge counts and integrate into AppLayout",
            "description": "Add reactive badge count calculation using applyFilter and integrate SmartViewSidebar into AppLayout.tsx alongside existing Sidebar.",
            "dependencies": [
              1,
              3
            ],
            "details": "",
            "status": "done",
            "testStrategy": "",
            "parentId": "undefined",
            "updatedAt": "2026-01-06T21:12:10.478Z"
          }
        ],
        "updatedAt": "2026-01-06T21:12:10.478Z"
      },
      {
        "id": 45,
        "title": "[v2-T6] FSRS integration: scheduling fields, review UI, response time tracking",
        "description": "Ensure FSRS integration works with new card provenance model. Track response times for future personalization.",
        "details": "FSRS FIELDS (already in cards table):\n- stability, difficulty, elapsedDays, scheduledDays\n- reps, lapses, state\n- dueDate, lastReview\n\nNEW TRACKING:\n- responseTimeMs in review_logs (already added in Task 1)\n- Track time from card shown to answer revealed\n- Track time from answer revealed to rating\n\nREVIEW UI UPDATES:\n\n1. PROVENANCE DISPLAY:\n- Show source: 'From: [Topic Name]'\n- Click to navigate to NotebookTopicPage\n- Show related cards count\n\n2. ZERO-DECISION FLOW:\n- Show Answer (Space)\n- Continue (Enter) = auto-grade based on response time\n- I Forgot (F) = grade as Again\n- Edit (E) = open card editor\n- Skip (S) = skip without grading\n\n3. LOW-EASE FLAGGING:\n- If card ease < 2.0 after review, flag for attention\n- Show in Weak Topics smart view\n- Suggest 'fix card' flow\n\nRESPONSE TIME LOGIC:\n- Fast correct (< 5s): increase ease slightly\n- Slow correct (> 15s): decrease ease slightly\n- Helps identify cards that need improvement\n\nCOMPONENTS:\n\n- Update src/components/review/ReviewInterface.tsx\n- Add response time tracking\n- Add provenance display\n- Connect to NotebookTopicPage navigation",
        "testStrategy": "Review card, verify response time logged. Test fast answer increases ease. Test slow answer decreases ease. Test low-ease card appears in Weak Topics. Test provenance link navigates correctly.",
        "priority": "high",
        "dependencies": [
          "41",
          "42"
        ],
        "status": "pending",
        "subtasks": []
      },
      {
        "id": 91,
        "title": "Debug and Fix Ollama AI Extraction Pipeline",
        "description": "Troubleshoot and resolve AI extraction issues with Ollama integration, focusing on JSON parsing, model compatibility, and response handling in the extractConcepts() function",
        "details": "",
        "testStrategy": "",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-06T04:58:26.652Z"
      },
      {
        "id": 112,
        "title": "Sidebar Consolidation: merge SmartViewSidebar into Sidebar",
        "description": "Delete SmartViewSidebar.tsx, consolidate navigation into single Sidebar component with DO NOW and LIBRARY sections",
        "details": "DO NOW: Review (primary), Inbox (secondary). LIBRARY: Notebook, Knowledge Bank. KB shows ALL items with inbox at top; Inbox is pre-filtered shortcut. Remove: Capture, Today, Queue, Topics, Stats.",
        "testStrategy": "Verify single sidebar renders, navigation works, badge counts update",
        "priority": "high",
        "dependencies": [
          "44"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Update Sidebar.tsx: Add Capture at top and restructure sections",
            "description": "Move Capture to top of sidebar (above sections), rename 'Main' section to 'DO NOW', and add Inbox as new nav item with unprocessed count",
            "dependencies": [],
            "details": "In src/components/layout/Sidebar.tsx: (1) Extract Capture from mainNavItems array, (2) Render Capture button above nav sections at line ~164, (3) Change section header 'Main' to 'DO NOW' at line 175, (4) Add Inbox import from lucide-react at line 2-12, (5) Create new NavItem for Inbox with id='inbox', icon=Inbox, badge=inboxCount (reusing existing inboxCount from line 42), (6) Add Inbox to mainNavItems array after Review button, (7) Keep existing NavButton component pattern for consistency",
            "status": "pending",
            "testStrategy": "Verify Capture button appears at top above sections, DO NOW section header displays correctly, Inbox nav item renders with badge count",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Add Review emphasis styling with subtle glow when cards due",
            "description": "Enhance Review button styling to show subtle glow ring effect when dueCount > 0 for visual emphasis",
            "dependencies": [
              1
            ],
            "details": "In src/components/layout/Sidebar.tsx NavButton component (line 89-152): Add conditional ring styling to Review button when item.id === 'review' && item.badge > 0. Apply classes: 'ring-2 ring-primary/20 ring-offset-2 ring-offset-background/50' to create subtle glow effect. This should be applied to the button element at line 94-107. Maintain existing hover and active states while adding the glow as an additional visual cue.",
            "status": "pending",
            "testStrategy": "Test with dueCount=0 (no glow) and dueCount>0 (subtle glow visible), verify glow doesn't interfere with hover/active states",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Remove Topics and Stats from secondary navigation",
            "description": "Delete Topics and Stats nav items from secondaryNavItems array in Sidebar.tsx",
            "dependencies": [
              1
            ],
            "details": "In src/components/layout/Sidebar.tsx at line 74-78: Remove the Topics and Stats items from secondaryNavItems array. This array should only contain Notebook item after removal. The Tag and BarChart3 imports from lucide-react (lines 7-8) can also be removed. Keep the 'Library' section header and structure intact.",
            "status": "pending",
            "testStrategy": "Verify secondaryNavItems only contains Notebook, Topics and Stats no longer render in LIBRARY section",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Update AppLayout.tsx: Remove SmartViewSidebar component",
            "description": "Delete SmartViewSidebar import and rendering from AppLayout.tsx",
            "dependencies": [
              1,
              2,
              3
            ],
            "details": "In src/components/layout/AppLayout.tsx: (1) Remove SmartViewSidebar import at line 11, (2) Delete the entire <aside> section containing SmartViewSidebar at lines 125-127, (3) Keep the main Sidebar component and all other layout structure intact. This removes the separate Smart Views sidebar panel from the layout, consolidating all navigation into the single Sidebar component.",
            "status": "pending",
            "testStrategy": "Verify layout renders with only single Sidebar, no second sidebar panel, main content area expands correctly",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Delete SmartViewSidebar.tsx and clean up unused Smart View state",
            "description": "Delete SmartViewSidebar.tsx file and remove obsolete smartViewCounts for deleted views (today, queue, weak)",
            "dependencies": [
              4
            ],
            "details": "File operations: (1) Delete src/components/layout/SmartViewSidebar.tsx entirely. State cleanup in src/stores/useAppStore.ts: (2) At line 73-79, update smartViewCounts initialization to only include inbox: 0 and notebook: 0 (remove today, queue, weak), (3) In refreshSmartViewCounts function (line 85-99), simplify counts object to only calculate inbox and notebook counts, remove today/queue/weak calculations. Note: Keep the smartViewCounts structure itself as it's used by Inbox nav item badge. Also consider if src/lib/system-views.ts SYSTEM_VIEWS array needs updating (currently defines today/queue/weak views).",
            "status": "pending",
            "testStrategy": "Verify SmartViewSidebar.tsx deleted, app runs without errors, inbox count still updates correctly in Sidebar badge",
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2026-01-06T23:19:24.740Z"
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2026-01-07T00:32:56.160Z",
      "taskCount": 18,
      "completedCount": 13,
      "tags": [
        "master"
      ],
      "created": "2026-01-07T00:53:48.742Z",
      "description": "Tasks for master context"
    }
  }
}