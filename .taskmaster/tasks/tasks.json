{
  "master": {
    "tasks": [
      {
        "id": "1",
        "title": "Database schema expansion for Quick Dump queue and medical features",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "2",
        "title": "AI service integration layer",
        "status": "done",
        "dependencies": [
          "1"
        ],
        "subtasks": []
      },
      {
        "id": "3",
        "title": "[ARCHIVED] AI-guided capture interface (v1)",
        "status": "done",
        "dependencies": [
          "2"
        ],
        "subtasks": []
      },
      {
        "id": "5",
        "title": "Zero-decision review interface (eliminate grading buttons)",
        "status": "done",
        "dependencies": [
          "1"
        ],
        "subtasks": []
      },
      {
        "id": "10",
        "title": "Global search with <200ms response time",
        "status": "done",
        "dependencies": [
          "1"
        ],
        "subtasks": []
      },
      {
        "id": "17",
        "title": "Auto-start Ollama from Electron on first AI request",
        "status": "done",
        "dependencies": [
          "2"
        ],
        "subtasks": []
      },
      {
        "id": "31",
        "title": "BUG FIX: Quick Dump saves to notes table instead of quick_dumps table",
        "status": "done",
        "dependencies": [
          "1"
        ],
        "subtasks": []
      },
      {
        "id": "35",
        "title": "[v2-T1] Data model v3: SourceItem, CanonicalTopic, NotebookTopicPage, SmartView schemas",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "36",
        "title": "[v2-T1.1] Topic normalization: alias table, matching rules, dedupe prevention",
        "status": "done",
        "dependencies": [
          "35"
        ],
        "subtasks": []
      },
      {
        "id": "38",
        "title": "[v2-T2] Capture pipeline: Quick Dump â†’ SourceItem (inbox), text + image support",
        "status": "done",
        "dependencies": [
          "35"
        ],
        "subtasks": []
      },
      {
        "id": "40",
        "title": "[v2-T3] Archive UI: vertical list grouped by status, search, filters",
        "status": "done",
        "dependencies": [
          "39"
        ],
        "subtasks": []
      },
      {
        "id": "41",
        "title": "[v2-T4] Notebook UI: topic pages, add blocks from sources, enforce card-creation here only",
        "status": "done",
        "dependencies": [
          "40",
          "36"
        ],
        "subtasks": []
      },
      {
        "id": "42",
        "title": "Card Generation from Notebook Blocks",
        "status": "done",
        "dependencies": [
          "41"
        ],
        "subtasks": []
      },
      {
        "id": "44",
        "title": "[v2-T8] Smart Views: system views (Inbox, Today, Queue, Weak Topics), filter engine",
        "status": "done",
        "dependencies": [
          "35"
        ],
        "subtasks": []
      },
      {
        "id": "45",
        "title": "[v2-T6] FSRS integration: scheduling fields, review UI, response time tracking",
        "status": "done",
        "dependencies": [
          "41",
          "42"
        ],
        "subtasks": []
      },
      {
        "id": "91",
        "title": "Debug and Fix Ollama AI Extraction Pipeline",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "112",
        "title": "Sidebar Consolidation: merge SmartViewSidebar into Sidebar",
        "status": "done",
        "dependencies": [
          "44"
        ],
        "subtasks": []
      },
      {
        "id": "113",
        "title": "Image Capture Support: paste, drop, display in KB/Notebook",
        "status": "cancelled",
        "dependencies": [
          "38",
          "41"
        ],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.363Z"
      },
      {
        "id": "114",
        "title": "Backup/Restore UI: auto-save toast, Settings restore button",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "115",
        "title": "Card Browser: view all cards with filters (topic, status, due date)",
        "status": "done",
        "dependencies": [
          "42",
          "45"
        ],
        "subtasks": []
      },
      {
        "id": "116",
        "title": "Browser Capture Hook: local HTTP API for Tampermonkey integration",
        "status": "cancelled",
        "dependencies": [
          "38"
        ],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.443Z"
      },
      {
        "id": "117",
        "title": "Basic Learning Mode: post-review mistakes summary with elaborated feedback",
        "status": "done",
        "dependencies": [
          "45"
        ],
        "subtasks": []
      },
      {
        "id": "118",
        "title": "Two-Mode Capture: FAB modal with auto-classification and Process Now button",
        "status": "done",
        "dependencies": [
          "38"
        ],
        "subtasks": []
      },
      {
        "id": "119",
        "title": "Insight Writing Modal: Redesign Add to Notebook Flow",
        "status": "cancelled",
        "dependencies": [
          "118",
          "125"
        ],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.519Z"
      },
      {
        "id": "120",
        "title": "NotebookBlock Schema Extension for AI Evaluation",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "121",
        "title": "AI Insight Evaluation Endpoint",
        "status": "done",
        "dependencies": [
          "120"
        ],
        "subtasks": []
      },
      {
        "id": "122",
        "title": "AI Feedback Panel in Insight Modal",
        "status": "done",
        "dependencies": [
          "119",
          "121"
        ],
        "subtasks": []
      },
      {
        "id": "123",
        "title": "Learning Tab Weak Points Panel",
        "status": "done",
        "dependencies": [
          "120",
          "122"
        ],
        "subtasks": []
      },
      {
        "id": "124",
        "title": "Tampermonkey Script Integration for Quick Capture",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "125",
        "title": "Data Logging Framework: Schema Extensions for Future AI",
        "status": "cancelled",
        "dependencies": [
          "118",
          "117"
        ],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.587Z"
      },
      {
        "id": "126",
        "title": "v16 Migration: Create notebook_links Table",
        "status": "cancelled",
        "dependencies": [],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.661Z"
      },
      {
        "id": "127",
        "title": "Workflow 2 FIX: Prominent 'What did you learn?' Insight UI",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "128",
        "title": "Workflow 1: Quick Capture Completion",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "129",
        "title": "Step 2: Inbox Review - Polish",
        "description": "Polish the Inbox Review screen per canonical workflow. Row display: title, [Board Q] badge, excerpt, correctness indicator (âœ“/âœ—), relative time. Detail panel on click with [Add to Notebook] button. Batch actions: Archive (status='curated'), Delete (with confirm). See docs/Workflow_Guide.ini Step 2.",
        "details": "WORKFLOW 4: BROWSE INBOX COMPLETION\n\nSCREEN MOCKUP:\n```\n+-----------------------------------------------------------------------------+\n|  INBOX (23 items)                                                          |\n|                                                                             |\n|  [Search...]                    [Sort: Newest v]  [Filter: All Types v]    |\n|                                                                             |\n|  -------------------------------------------------------------------------  |\n|                                                                             |\n|  [ ] CKD G3 - CV Mortality                [Nephro] QBank check   2 hrs ago |\n|  [ ] Afib Rate Control vs Rhythm          [Cardio] QBank x       3 hrs ago |\n|  [ ] COPD Exacerbation Management         [Pulm]   QBank check   Yesterday |\n|  [ ] Diabetic Ketoacidosis Workup         [Endo]   QBank x       Yesterday |\n|  [ ] UpToDate: Heart Failure Guidelines   [Cardio] Article       2 days    |\n|  ...                                                                        |\n|                                                                             |\n|  -------------------------------------------------------------------------  |\n|                                                                             |\n|  With selected: [Add to Notebook] [Archive] [Delete]                       |\n|                                                                             |\n+-----------------------------------------------------------------------------+\n```\n\nCURRENT STATE:\n- List view works\n- Search works\n- Delete works\n\nMISSING/BROKEN:\n1. Archive uses DELETE instead of status='curated'\n2. Filter by sourceType not implemented\n3. Sort options not implemented\n4. Batch selection not implemented\n\nFLOW:\n1. User opens Inbox from sidebar\n2. Load items: sourceItemQueries.getByStatus('inbox')\n3. User can:\n   - Click item -> View source detail modal\n   - Select + [Add to Notebook] -> Workflow 2\n   - Select + [Archive] -> status = 'curated' (NOT delete)\n   - Select + [Delete] -> DELETE with confirmation\n4. Filters: by sourceType, domain (from metadata.subject)\n5. Sort: by createdAt (newest/oldest)\n\nDATABASE OPERATIONS:\n```typescript\n// List inbox\nconst items = await window.api.getSourceItemsByStatus('inbox');\n\n// Archive (mark as curated) - FIX THIS\nawait window.api.updateSourceItemStatus(id, 'curated');\n\n// Delete\nawait window.api.deleteSourceItem(id);\n```\n\nFILTERS TO ADD:\n- sourceType: qbank, article, pdf, image, quickcapture, manual, all\n- domain: from metadata.subject field, dynamically populated\n\nSORT OPTIONS:\n- Newest first (default)\n- Oldest first\n- By domain (alphabetical)\n- By type\n\nBATCH OPERATIONS:\n- Checkbox selection on each row\n- \"Select All\" checkbox in header\n- Batch actions: Add to Notebook (opens for first selected), Archive, Delete\n- Archive batch: no confirmation needed\n- Delete batch: \"Delete X items? This cannot be undone.\"\n\nEDGE CASES:\n\nEmpty inbox:\n- Show: \"Inbox empty! Capture some content to get started.\" [Capture]\n\nBatch actions on many items:\n- Archive: Update all, no confirmation needed\n- Delete: Confirm \"Delete X items? This cannot be undone.\"",
        "testStrategy": "Test Archive changes status to 'curated' not delete. Test archived items no longer appear in inbox. Test filter by sourceType works. Test sort by newest/oldest works. Test batch selection with Select All. Test batch archive updates all without confirmation. Test batch delete shows confirmation. Test empty inbox shows capture prompt.",
        "priority": "medium",
        "dependencies": [],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-25T18:09:20.721Z"
      },
      {
        "id": "130",
        "title": "Step 4: Notebook Topic Page - Polish",
        "description": "Polish the Notebook Topic Page per canonical workflow. Block cards show: title, source badge + correctness (âœ“/âœ—) + relative time, content (user insight), confusion note if present. Footer: card count + [Edit] [+ Card] [View Source]. See docs/Workflow_Guide.ini Step 4.",
        "details": "WORKFLOW 5: BROWSE NOTEBOOK COMPLETION\n\nSCREEN MOCKUP:\n```\n+-----------------------------------------------------------------------------+\n|  NOTEBOOK                                                [Search...]       |\n|                                                                             |\n|  +--------------+ +----------------------------------------------------+   |\n|  | DOMAINS      | |  Chronic Kidney Disease                   12 blocks|   |\n|  |              | |                                                    |   |\n|  | v Nephrology | |  +----------------------------------------------+ |   |\n|  |   - CKD (12) | |  | CKD - CV Mortality Risk            2hrs ago  | |   |\n|  |   - AKI (5)  | |  | [Cardio] [Mgmt] [Cross-Topic]                | |   |\n|  |   - GN (3)   | |  | \"CKD patients 4-5x more likely to die...\"    | |   |\n|  |              | |  | Links: 3  Source: 1  Cards: 0                | |   |\n|  | > Cardiology | |  +----------------------------------------------+ |   |\n|  | > Pulmonology| |                                                    |   |\n|  | > GI         | |  +----------------------------------------------+ |   |\n|  | > Endocrine  | |  | CKD Staging and GFR                2 days ago| |   |\n|  | ...          | |  | [Dx] [Boards-HY]                             | |   |\n|  |              | |  | \"Stage G3a: 45-59, G3b: 30-44...\"            | |   |\n|  | ------------ | |  | Links: 2  Source: 2  Cards: 1                | |   |\n|  | FILTERS:     | |  +----------------------------------------------+ |   |\n|  | [ ] Cross-Top| |                                                    |   |\n|  | [ ] Boards-HY| |  [+ Add Block]                                    |   |\n|  | [ ] No Cards | |                                                    |   |\n|  +--------------+ +----------------------------------------------------+   |\n|                                                                             |\n+-----------------------------------------------------------------------------+\n```\n\nCURRENT STATE:\n- Domain tree sidebar works\n- Topic selection works\n- Block list works\n\nMISSING:\n1. Cross-block search (search all blocks by content)\n2. Filters in sidebar: Cross-Topic, Boards-HY, No Cards\n3. Block counts in domain tree\n\nFLOW:\n1. User opens Notebook from sidebar\n2. Left sidebar: domains with nested topics\n   - Expand domain -> show topics with block counts\n3. Click topic -> load blocks for that topic's page\n4. Click block card -> Workflow 6 (Block Detail)\n5. Filters affect block list\n6. Search searches across ALL blocks (content field)\n\nDATABASE QUERIES:\n```typescript\n// Get domain tree with counts\nconst topics = await window.api.getAllCanonicalTopics();\n// Group by domain, count blocks per topic\n\n// Get blocks for topic\nconst page = await window.api.getNotebookTopicPageByTopic(topicId);\nconst blocks = await window.api.getNotebookBlocksByPage(page.id);\n\n// For each block, fetch source info\nfor (const block of blocks) {\n  block.source = await window.api.getSourceItem(block.sourceItemId);\n}\n\n// NEW: Search all blocks by content\nconst searchResults = await window.api.searchNotebookBlocks(query);\n// Returns blocks with topic name, content excerpt, match highlights\n```\n\nFILTERS (sidebar checkboxes):\n\n[ ] Cross-Topic:\n- Show only blocks where source has multiple canonicalTopicIds\n- OR blocks tagged with 'Cross-Topic'\n\n[ ] Boards-HY:\n- Show only blocks tagged with 'Boards-HY' or 'High-Yield'\n\n[ ] No Cards:\n- Show only blocks where cardCount = 0\n- Helps identify content not yet converted to cards\n\nSEARCH:\n- Search box in header searches ALL notebook blocks\n- Searches block.content field\n- Returns results grouped by topic\n- Click result -> navigate to that topic and highlight block\n\nIPC TO ADD:\n```typescript\n// Search notebook blocks by content\nwindow.api.searchNotebookBlocks(query: string): Promise<Array<{\n  block: DbNotebookBlock;\n  topicName: string;\n  excerpt: string;  // Content snippet with match\n}>>\n```\n\nUI UPDATES:\n- Add search input in notebook header\n- Add filter checkboxes in sidebar below domain tree\n- Add block count badges next to each topic in tree\n- Search results appear in main area, replacing topic view temporarily",
        "testStrategy": "Test cross-block search finds blocks by content. Test search results show topic name and excerpt. Test clicking search result navigates to topic. Test Cross-Topic filter shows multi-topic blocks. Test Boards-HY filter shows tagged blocks. Test No Cards filter shows blocks with cardCount=0. Test block counts appear in domain tree. Test filters can be combined.",
        "priority": "medium",
        "dependencies": [],
        "status": "cancelled",
        "subtasks": [],
        "updatedAt": "2026-01-25T18:51:29.773Z"
      },
      {
        "id": "131",
        "title": "Workflow 7: Edit Block",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "132",
        "title": "Workflow 8: Add Source to Another Topic",
        "status": "cancelled",
        "dependencies": [
          "126"
        ],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.742Z"
      },
      {
        "id": "133",
        "title": "Workflow 9: Add Manual Link",
        "status": "done",
        "dependencies": [
          "126"
        ],
        "subtasks": []
      },
      {
        "id": "134",
        "title": "Workflow 10: Remove Link",
        "status": "done",
        "dependencies": [
          "126",
          "133"
        ],
        "subtasks": []
      },
      {
        "id": "135",
        "title": "Workflow 6 Enhancement: Links Sidebar with Hover-Highlight",
        "status": "cancelled",
        "dependencies": [
          "126",
          "133",
          "134"
        ],
        "subtasks": [],
        "updatedAt": "2026-01-24T02:47:41.817Z"
      },
      {
        "id": "136",
        "title": "Workflow 13: Edit Card - Add Reset Progress Button",
        "status": "done",
        "dependencies": [],
        "subtasks": []
      },
      {
        "id": "137",
        "title": "Workflow 3: AI Backlink Detection (Async)",
        "priority": "medium",
        "dependencies": [
          "126",
          "127"
        ],
        "status": "cancelled",
        "subtasks": [],
        "updatedAt": "2026-01-24T01:59:56.187Z"
      },
      {
        "id": "138",
        "title": "Step 3: Add to Notebook - AI-Assisted Insight Extraction",
        "description": "Enhance the Add to Notebook modal with AI-assisted insight extraction. AI identifies what the source tested (auto on modal open), user writes takeaway in their own words (active recall), optional AI polish to clean up/enhance their writing. User stays in control throughout.",
        "details": "STEP 3: ADD TO NOTEBOOK - AI-ASSISTED INSIGHT EXTRACTION\n\nPRINCIPLE: User in control, AI assists\n- User types/picks topic -> AI normalizes silently via autocomplete\n- User writes insight -> AI evaluates on request (existing Get Feedback)\n- User can polish -> AI suggests cleaned version (new)\n\nUI FLOW:\n```\nModal Opens\n    |\n    v\nAI identifies tested concept (loading state)\n    |\n    v\nUser sees 'This question tested: X'\nUser writes in textarea\n    |\n    |--- User clicks [Save] ---------> Saves original text\n    |\n    |--- User clicks [Polish] -------> AI generates polished version\n                                       Show comparison panel\n                                       [Keep Original] [Use Polished]\n                                           |\n                                           v\n                                       Selected version in textarea\n                                       User clicks [Save to Notebook]\n```\n\nUI MOCKUP:\n```\n+-------------------------------------------------------------+\n|  ADD TO NOTEBOOK                                       [x]  |\n+-------------------------------------------------------------+\n|  Source Preview                                    [Expand] |\n+-------------------------------------------------------------+\n|  Topic                                                      |\n|  [autocomplete input - already implemented]                 |\n+-------------------------------------------------------------+\n|  CONCEPT TESTED                          (auto-generated)   |\n|  'First-line treatment for status epilepticus'              |\n+-------------------------------------------------------------+\n|  YOUR TAKEAWAY                                              |\n|  What did you learn? Write in your own words.               |\n|  +--------------------------------------------------------+ |\n|  | benzos first like lorazepam. dont wait...              | |\n|  +--------------------------------------------------------+ |\n|                                   Min 20 chars    [Polish]  |\n+-------------------------------------------------------------+\n|  (Polish Panel - appears after clicking Polish)             |\n|  Your version: 'benzos first like lorazepam...'             |\n|  Polished: 'Benzodiazepines (lorazepam, midazolam) are...'  |\n|  Added context: lorazepam/midazolam examples, >5min         |\n|  [Keep Original]  [Use Polished]                            |\n+-------------------------------------------------------------+\n|                     [Get Feedback]  [Save to Notebook]      |\n+-------------------------------------------------------------+\n```\n\nNEW AI FUNCTIONS (ai-service.ts):\n1. identifyTestedConcept(sourceContent, sourceType)\n   - Returns: { concept: string, confidence: 'high'|'medium'|'low' }\n   - Prompt varies by sourceType (QBank vs textbook vs lecture)\n\n2. polishInsight(userText, sourceContent, testedConcept)\n   - Returns: { polished: string, fromUser: string[], addedContext: string[] }\n   - Cleans up language, expands abbreviations\n   - CAN add relevant details from source (Option 2)\n   - Tracks what was added for transparency\n\nNEW IPC HANDLERS:\n- ai:identifyTestedConcept\n- ai:polishInsight\n\nNEW TYPES:\n- TestedConceptResult { concept, confidence }\n- PolishInsightParams { userText, sourceContent, testedConcept? }\n- PolishedInsightResult { polished, fromUser[], addedContext[] }\n\nCOMPONENT CHANGES:\n1. AddToNotebookWorkflow.tsx:\n   - Add state: testedConcept, isLoadingConcept, showPolishPanel, polishedVersion, isPolishing\n   - On modal open: call identifyTestedConcept()\n   - Add ConceptTestedBadge section\n   - Add PolishPanel component\n   - Handlers: handlePolish, handleKeepOriginal, handleUsePolished\n\n2. InsightTextarea.tsx:\n   - Add optional [Polish] button when valid\n   - Pass onPolishClick callback\n\nEXISTING COMPONENTS (keep as-is):\n- TopicSelector (just refactored to autocomplete)\n- BoardRelevancePanel\n- SourcePreviewPanel\n- Get Feedback button (existing AI evaluation)\n\nEDGE CASES:\n- AI can't identify concept (low confidence): Show generic 'What's the key takeaway?'\n- Polish fails: Toast error, keep original text\n- Non-QBank sources: Different prompts for textbook/lecture/article",
        "testStrategy": "Test concept identification runs on modal open. Test loading state shows while identifying. Test concept displays correctly for QBank sources. Test Polish button appears when insight is valid. Test Polish loading state. Test polished version comparison panel shows both versions. Test 'Added context' shows what AI added. Test Keep Original closes panel and keeps original. Test Use Polished replaces textarea content. Test Save saves whatever is in textarea. Test works with existing Get Feedback flow. Test error handling for AI failures.",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "AI Service: identifyTestedConcept function",
            "status": "done",
            "details": "Add identifyTestedConcept(sourceContent, sourceType) to ai-service.ts. Returns { concept, confidence }. Different prompts for QBank vs textbook vs lecture.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "AI Service: polishInsight function",
            "status": "done",
            "details": "Add polishInsight(userText, sourceContent, testedConcept) to ai-service.ts. Returns { polished, fromUser[], addedContext[] }. Cleans language, can add relevant details, tracks additions.\n<info added on 2026-01-25T15:37:40.129Z>\nImplemented in electron/ai-service.ts as polishInsightWithFallback() which delegates to electron/ai/tasks/polish-insight.ts. Function accepts (userText, sourceContent, testedConcept) and returns { polished, fromUser, addedContext }. Includes response caching for identical inputs and graceful error handling that returns original user text if AI processing fails.\n</info added on 2026-01-25T15:37:40.129Z>",
            "updatedAt": "2026-01-25T15:37:43.860Z",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "IPC Handlers for new AI functions",
            "status": "done",
            "details": "Add ai:identifyTestedConcept and ai:polishInsight IPC handlers. Add types to electron.d.ts and preload.ts.",
            "parentId": "undefined",
            "updatedAt": "2026-01-25T15:37:43.865Z"
          },
          {
            "id": 4,
            "title": "AddToNotebookWorkflow: Concept identification on open",
            "status": "done",
            "details": "Add state and useEffect to call identifyTestedConcept when modal opens. Show loading state, then display concept badge.",
            "parentId": "undefined",
            "updatedAt": "2026-01-25T15:37:43.868Z"
          },
          {
            "id": 5,
            "title": "InsightTextarea: Add Polish button",
            "status": "done",
            "details": "Add optional Polish button that appears when insight is valid. Pass onPolishClick callback to parent.",
            "parentId": "undefined",
            "updatedAt": "2026-01-25T15:37:43.870Z"
          },
          {
            "id": 6,
            "title": "AddToNotebookWorkflow: Polish panel UI and handlers",
            "status": "done",
            "details": "Add PolishPanel UI showing original vs polished, added context list, Keep Original and Use Polished buttons. Includes handlers: handlePolish() calls AI and shows panel, handleKeepOriginal() closes panel, handleUsePolished() replaces textarea content and closes panel. Panel appears below InsightTextarea when Polish is clicked.",
            "parentId": "undefined",
            "updatedAt": "2026-01-25T15:37:43.871Z"
          }
        ],
        "updatedAt": "2026-01-25T15:37:43.871Z"
      },
      {
        "id": "139",
        "title": "Notebook Redesign: Topic Browser (Screen 1)",
        "description": "Replace current flat topic list with smart Topic Browser featuring Needs Attention, Recently Updated, and domain-grouped All Topics sections. Inspired by AMBOSS navigation - surfaces weak areas automatically.",
        "details": "DESIGN PHILOSOPHY: Reading-focused, surfaces weak areas automatically\n\nLAYOUT:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  ğŸ““ Notebook                                   [ğŸ”] [+ New Topic] â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  ğŸ” Search topics...                                      [âŒ˜K] â”‚\nâ”‚                                                                 â”‚\nâ”‚  NEEDS ATTENTION                                                â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚  âš ï¸  Acute MI              62% accuracy â€¢ 3 new sources â”‚   â”‚\nâ”‚  â”‚  âš ï¸  Status Epilepticus    45% accuracy â€¢ Low-ease cardsâ”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”‚                                                                 â”‚\nâ”‚  RECENTLY UPDATED                                               â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚  CHF Management            Updated 2h ago â€¢ 15 cards    â”‚   â”‚\nâ”‚  â”‚  Pneumonia Workup          Updated yesterday â€¢ 8 cards  â”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”‚                                                                 â”‚\nâ”‚  ALL TOPICS                                          [A-Z â–¾]   â”‚\nâ”‚  â–¸ Cardiology (4)                                              â”‚\nâ”‚      Acute MI â€¢ CHF â€¢ Arrhythmias â€¢ HOCM                       â”‚\nâ”‚  â–¸ Neurology (3)                                               â”‚\nâ”‚  â–¸ Pulmonology (2)                                             â”‚\nâ”‚                                                                 â”‚\nâ”‚  ğŸ“Š 47 topics â€¢ 156 cards â€¢ 89% retention                      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\nSMART SECTIONS (auto-generated):\n- Needs Attention: Topics with <70% accuracy OR low-ease cards OR unprocessed sources\n- Recently Updated: Last 7 days of activity\n- All Topics: Grouped by CanonicalTopic.domain, collapsible\n\nTOPIC ROW ANATOMY:\n- Default: Topic name + accuracy % + card count\n- Hover: [Open] [ğŸ´ Cards] [â‹®] actions appear (Things 3 style)\n\nDATA SOURCES:\n- getBoardRelevanceForTopic() for accuracy stats\n- CanonicalTopic.domain for specialty grouping\n- NotebookTopicPage.updatedAt for recency\n- Card counts from existing queries\n- Low-ease detection from FSRS card data\n\nCOMPONENTS TO CREATE:\n- TopicBrowser.tsx (replaces TopicPageList.tsx)\n- NeedsAttentionSection.tsx\n- RecentlyUpdatedSection.tsx  \n- DomainGroupedTopics.tsx (collapsible specialty tree)\n- TopicRow.tsx (with hover actions)\n\nKEEP SIDEBAR: Navigation stays in left sidebar area, main content on right\n\nFOOTER STATS: Total topics, total cards, overall retention rate",
        "testStrategy": "Test Needs Attention shows topics with <70% accuracy. Test Recently Updated shows last 7 days. Test domain grouping collapses/expands. Test topic search filters all sections. Test hover actions appear on topic rows. Test clicking topic navigates to Topic Article view. Test footer stats are accurate.",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "IPC: getTopicsWithStats query",
            "status": "pending",
            "details": "Create IPC handler that returns all topics with: accuracy % (from board relevance), card count, block count, updatedAt, domain. Single query to power all sections.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "IPC: getLowEaseTopics query",
            "status": "pending",
            "details": "Create IPC handler that returns topics with low-ease cards (ease < 2.0). Used for Needs Attention section.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "TopicBrowser container component",
            "status": "pending",
            "details": "Create TopicBrowser.tsx as main container. Fetches data, manages search state, renders three sections. Replaces TopicPageList.tsx.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "NeedsAttentionSection component",
            "status": "pending",
            "details": "Renders topics with <70% accuracy OR low-ease cards. Amber background, warning icon, shows accuracy % and indicators.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "RecentlyUpdatedSection component",
            "status": "pending",
            "details": "Renders topics updated in last 7 days. Shows relative time and card count. Simple white background.",
            "parentId": "undefined"
          },
          {
            "id": 6,
            "title": "DomainGroupedTopics component",
            "status": "pending",
            "details": "Collapsible specialty tree. Groups topics by CanonicalTopic.domain. Shows topic count per domain. Expand/collapse with chevron.",
            "parentId": "undefined"
          },
          {
            "id": 7,
            "title": "TopicRow component with hover actions",
            "status": "pending",
            "details": "Reusable topic row. Shows name + stats. On hover: [Open] [Cards] [More] buttons fade in from right. Click navigates to Topic Article.",
            "parentId": "undefined"
          },
          {
            "id": 8,
            "title": "Topic search filtering",
            "status": "pending",
            "details": "Search input filters all sections in real-time. Client-side filter on topic name and aliases.",
            "parentId": "undefined"
          },
          {
            "id": 9,
            "title": "Footer stats aggregation",
            "status": "pending",
            "details": "Display total topics, total cards, overall retention rate at bottom of browser.",
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2026-01-25T21:23:25.031Z"
      },
      {
        "id": "140",
        "title": "Notebook Redesign: Topic Article View (Screen 2)",
        "description": "Replace block-card view with AMBOSS-style prose article. Blocks render as flowing content with callouts (Pearl/Trap/Caution), footnotes for sources, and collapsible Board Relevance panel at top.",
        "details": "DESIGN PHILOSOPHY: Read like AMBOSS, edit like OneNote\n\nLAYOUT:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  â† Back to Topics          Acute MI              [â‹®] [ğŸ´ Gen]  â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚  â”Œâ”€ ğŸ“Š BOARD RELEVANCE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[Hide â–¾]â”€â”€â”€â”€â”  â”‚\nâ”‚  â”‚  You've seen 8 questions on this topic.                  â”‚  â”‚\nâ”‚  â”‚  Your accuracy: 62% (5/8)                                â”‚  â”‚\nâ”‚  â”‚  ğŸ¯ Common exam traps: Troponin timing (missed 2x)       â”‚  â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\nâ”‚                                                                 â”‚\nâ”‚  # Acute Myocardial Infarction                                 â”‚\nâ”‚  _Also known as: STEMI, MI, Heart Attack_                      â”‚\nâ”‚  _12 cards â€¢ 4 sources â€¢ Last updated 2h ago_                  â”‚\nâ”‚                                                                 â”‚\nâ”‚  ## Biomarkers                                                 â”‚\nâ”‚                                                                 â”‚\nâ”‚  Troponin I is the most specific marker for myocardial         â”‚\nâ”‚  injury, with levels rising **3-6 hours** after onset.Â¹        â”‚\nâ”‚                                                                 â”‚\nâ”‚  â”Œâ”€ ğŸ’¡ CLINICAL PEARL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\nâ”‚  â”‚  In renal failure, troponin can be chronically elevated. â”‚  â”‚\nâ”‚  â”‚  Look for a rising pattern (>20% change).Â²               â”‚  â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\nâ”‚                                                                 â”‚\nâ”‚  â”Œâ”€ âš ï¸ EXAM TRAP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\nâ”‚  â”‚  Always consider posterior MI if inferior STEMI with     â”‚  â”‚\nâ”‚  â”‚  ST depression in V1-V3. Get posterior leads.â´           â”‚  â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\nâ”‚                                                                 â”‚\nâ”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚\nâ”‚  SOURCES                                                       â”‚\nâ”‚  Â¹ UWorld Q#1234 - Troponin Timing            [View Source â†’]  â”‚\nâ”‚  Â² Clinical Pearl - Dr. Smith                 [View Source â†’]  â”‚\nâ”‚                                                                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  [+ Add Content]                         [ğŸ´ Generate Cards]   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\nKEY DESIGN DECISIONS:\n1. No visible block boundaries - content flows as prose\n2. Markdown rendering with headers, bold, lists\n3. Max-width ~70ch (720px) for optimal readability\n4. Generous whitespace (Bear-inspired)\n\nCALLOUT BLOCKS (3 types):\n- ğŸ’¡ CLINICAL PEARL: bg-emerald-50 border-l-4 border-emerald-500\n- âš ï¸ EXAM TRAP: bg-amber-50 border-l-4 border-amber-500\n- ğŸš¨ CAUTION: bg-red-50 border-l-4 border-red-500\n\nSOURCE FOOTNOTES:\n- Superscript numbers in text (Â¹Â²Â³â´)\n- Footnote section at bottom with clickable [View Source â†’]\n- Clean reading flow - sources available but not intrusive\n\nBOARD RELEVANCE PANEL:\n- Collapsible (default open)\n- Shows: questions seen, accuracy %, exam traps from aiEvaluation\n- Uses existing getBoardRelevanceForTopic()\n\nSCHEMA CHANGE (migration v19):\nALTER TABLE notebook_blocks ADD COLUMN calloutType TEXT;\n-- Values: 'pearl' | 'trap' | 'caution' | null\n\nRENDERING LOGIC:\n- Blocks with aiEvaluation.examTrapType â†’ render as EXAM TRAP callout\n- Blocks can be manually marked as pearl/caution via calloutType\n- Blocks without callout render as regular prose paragraphs\n- Source references become footnotes\n\nCOMPONENTS TO CREATE/MODIFY:\n- TopicArticleView.tsx (replaces TopicPageView.tsx)\n- ArticleContent.tsx (renders blocks as prose)\n- CalloutBlock.tsx (Pearl/Trap/Caution styling)\n- SourceFootnotes.tsx (superscript + bottom section)\n- BoardRelevancePanel.tsx (exists, ensure prominent placement)",
        "testStrategy": "Test blocks render as flowing prose without visible boundaries. Test callout blocks display with correct styling. Test footnote numbers appear inline. Test footnote section shows all sources. Test Board Relevance panel collapses/expands. Test clicking View Source opens source detail. Test topic aliases display in header. Test card count and source count are accurate.",
        "priority": "high",
        "dependencies": [
          "139"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Schema migration: Add calloutType column",
            "status": "pending",
            "details": "Create v19 migration adding calloutType TEXT column to notebook_blocks. Values: 'pearl' | 'trap' | 'caution' | null. Update DbNotebookBlock type.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "TopicArticleView container component",
            "status": "pending",
            "details": "Create TopicArticleView.tsx replacing TopicPageView.tsx. Header with back button, topic title, Generate Cards button. Fetches blocks and renders ArticleContent.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "ArticleContent prose renderer",
            "status": "pending",
            "details": "Renders blocks as flowing prose. No visible block boundaries. Assigns footnote numbers to each block's source. Uses markdown rendering for content.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "CalloutBlock component",
            "status": "pending",
            "details": "Renders Pearl/Trap/Caution callouts. Takes calloutType prop. Applies correct styling: emerald for pearl, amber for trap, red for caution. Shows icon + header + content.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "SourceFootnotes component",
            "status": "pending",
            "details": "Renders footnote section at bottom. Lists all sources with superscript numbers. Each source has [View Source â†’] link to open source detail modal.",
            "parentId": "undefined"
          },
          {
            "id": 6,
            "title": "Topic header with aliases and stats",
            "status": "pending",
            "details": "Display topic title as H1, aliases in italics below, then stats line (card count, source count, last updated). Uses CanonicalTopic data.",
            "parentId": "undefined"
          },
          {
            "id": 7,
            "title": "Board Relevance Panel integration",
            "status": "pending",
            "details": "Position existing BoardRelevancePanel at top of article. Ensure collapsible state works. Blue background styling per design system.",
            "parentId": "undefined"
          },
          {
            "id": 8,
            "title": "Add Content and Generate Cards footer",
            "status": "pending",
            "details": "Footer with [+ Add Content] button (opens AddToNotebookWorkflow) and [Generate Cards] button (opens TopicCardGeneration from T142).",
            "parentId": "undefined"
          }
        ]
      },
      {
        "id": "141",
        "title": "Notebook Redesign: Inline Editing Mode",
        "description": "Add click-to-edit inline editing for Topic Article. Notion-style slash commands for inserting callouts, headings, and linking sources. Escape to cancel, Cmd+S to save.",
        "details": "TRIGGER: Click anywhere in content area, or press E key\n\nEDITING MODE UI:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  â† Back to Topics          Acute MI           [Preview] [Save] â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚  ## Biomarkers                                                 â”‚\nâ”‚                                                                 â”‚\nâ”‚  Troponin I is the most specific marker for myocardial         â”‚\nâ”‚  injury, with levels rising **3-6 hours** after onset.         â”‚\nâ”‚  â”‚                                              â† Cursor here  â”‚\nâ”‚                                                                 â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚  Type / for commands...                                 â”‚   â”‚\nâ”‚  â”‚  /h2      Insert heading                                â”‚   â”‚\nâ”‚  â”‚  /pearl   Insert clinical pearl callout                 â”‚   â”‚\nâ”‚  â”‚  /trap    Insert exam trap callout                      â”‚   â”‚\nâ”‚  â”‚  /caution Insert caution callout                        â”‚   â”‚\nâ”‚  â”‚  /source  Link a source from Archive                    â”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”‚                                                                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  Markdown supported â€¢ Escape to cancel â€¢ âŒ˜S to save            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\nSLASH COMMANDS:\n- /h2 or ## â†’ Section header\n- /pearl â†’ Clinical Pearl callout (sets calloutType on block)\n- /trap â†’ Exam Trap callout\n- /caution â†’ Caution callout\n- /source â†’ Opens source picker modal to link from Archive\n\nKEYBOARD SHORTCUTS:\n- E â†’ Enter edit mode (from reading view)\n- Escape â†’ Exit/cancel editing (discard changes)\n- âŒ˜S / Ctrl+S â†’ Save changes\n- **text** or âŒ˜B â†’ Bold\n\nCOMPONENTS:\n- InlineEditor.tsx (textarea or contenteditable with markdown preview)\n- SlashCommandMenu.tsx (dropdown menu triggered by / keypress)\n- SourcePicker.tsx (search Archive to link source as footnote)\n\nEDITING SCOPE:\n- Edit individual block content when clicking on a block\n- Can change block's calloutType via slash command\n- Can add new blocks via slash commands\n- Preserves sourceItemId linkage\n\nMVP ALTERNATIVE:\nFor initial implementation, modal editing (existing BlockEditModal) is acceptable.\nInline editing is enhancement for smoother UX - can be Phase 2.",
        "testStrategy": "Test pressing E enters edit mode. Test Escape cancels without saving. Test Cmd+S saves changes. Test slash commands show menu. Test /pearl sets calloutType to pearl. Test /source opens Archive picker. Test clicking outside editing area shows preview. Test markdown bold/headers render correctly.",
        "priority": "medium",
        "dependencies": [
          "140"
        ],
        "status": "pending",
        "subtasks": []
      },
      {
        "id": "142",
        "title": "Notebook Redesign: Topic Card Generation (Screen 3)",
        "description": "Replace per-block card generation with topic-level batch generation. AI scans entire topic content, suggests multiple cards of various types, user selects which to create.",
        "details": "TRIGGER: Click [ğŸ´ Generate Cards] button on Topic Article\n\nLAYOUT:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  GENERATE CARDS: Acute MI                                 [Ã—]  â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚  AI analyzed your topic and suggests these cards:              â”‚\nâ”‚                                                                 â”‚\nâ”‚  â˜‘ï¸  CARD 1 â€” Q&A                                  [Edit] [Ã—]  â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚  Q: What is the most specific cardiac biomarker for MI? â”‚   â”‚\nâ”‚  â”‚  A: Troponin I (rises 3-6h, peaks 12-24h, elevated 7-10dâ”‚   â”‚\nâ”‚  â”‚  Source: UWorld Q#1234                                  â”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”‚                                                                 â”‚\nâ”‚  â˜‘ï¸  CARD 2 â€” Clinical Vignette                    [Edit] [Ã—]  â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚  Q: 58M with inferior STEMI. ECG shows ST depression    â”‚   â”‚\nâ”‚  â”‚     V1-V3. What additional leads should you obtain?     â”‚   â”‚\nâ”‚  â”‚  A: Posterior leads V7-V9                               â”‚   â”‚\nâ”‚  â”‚  Source: MKSAP Case                                     â”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”‚                                                                 â”‚\nâ”‚  â˜  CARD 3 â€” Cloze                                 [Edit] [Ã—]  â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚  Door-to-balloon time should be {{c1::<90 minutes}}     â”‚   â”‚\nâ”‚  â”‚  Source: UpToDate                                       â”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”‚                                                                 â”‚\nâ”‚  ğŸ’¡ Tip: Uncheck cards you don't want. Click Edit to modify.   â”‚\nâ”‚                                                                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  [Cancel]          Selected: 2 of 4      [Create Selected Cards]â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\nCARD GENERATION LOGIC:\n1. AI receives ALL blocks in topic (concatenated content)\n2. AI suggests cards by type:\n   - Q&A for factual statements\n   - Cloze for fill-in-the-blank memorization  \n   - Clinical Vignette for exam-style scenarios\n3. Each card shows which source/block it came from\n4. User reviews, selects/deselects, edits before creating\n5. One decision point instead of per-block decisions\n\nAI PROMPT ENHANCEMENT:\n- Include topic's board relevance stats (accuracy, questions seen)\n- Include user's weak areas from aiEvaluation.gaps\n- Prioritize cards targeting weak concepts (F43 integration)\n\nCOMPONENTS:\n- TopicCardGeneration.tsx (modal/fullscreen)\n- SuggestedCardItem.tsx (checkbox + card preview + edit/remove)\n- CardEditInline.tsx (edit front/back/type before creating)\n\nIPC:\n- ai:generateCardsFromTopic(topicId) â†’ returns array of suggested cards\n- cards:batchCreate(cards[]) â†’ creates multiple cards at once\n\nDIFFERENCE FROM CURRENT:\n- Current: Generate one card at a time per block, user decides per-block\n- New: Generate all cards for topic at once, batch select, one decision",
        "testStrategy": "Test Generate Cards button opens modal. Test AI suggests multiple card types. Test cards show source attribution. Test checkbox selection works. Test Edit opens inline editing. Test X removes card from suggestions. Test Create Selected only creates checked cards. Test cards are properly linked to notebookTopicPageId. Test empty state when AI finds no card-worthy content.",
        "priority": "high",
        "dependencies": [
          "140"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "AI Service: generateCardsFromTopic function",
            "status": "pending",
            "details": "Create AI function that receives all blocks in a topic, board relevance stats, and generates array of suggested cards. Returns { cards: SuggestedCard[], meta: { topicName, blockCount } }. Card types: qa, cloze, vignette.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "IPC handlers for topic card generation",
            "status": "pending",
            "details": "Add ai:generateCardsFromTopic IPC handler. Add cards:batchCreate handler for creating multiple cards in single transaction. Update preload.ts and electron.d.ts.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "TopicCardGeneration modal component",
            "status": "pending",
            "details": "Create TopicCardGeneration.tsx modal. Shows loading state while AI generates. Displays list of SuggestedCardItems. Footer with Cancel and Create Selected buttons.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "SuggestedCardItem component",
            "status": "pending",
            "details": "Renders single suggested card with checkbox, card type badge, front/back preview, source attribution. Edit and X buttons on right. Checkbox toggles selection.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "CardEditInline component",
            "status": "pending",
            "details": "Inline editing for suggested card. Edit front, back, and card type. Save updates the suggestion in parent state. Cancel reverts changes.",
            "parentId": "undefined"
          },
          {
            "id": 6,
            "title": "Batch card creation flow",
            "status": "pending",
            "details": "Create Selected Cards button triggers batch creation. Progress indicator during creation. Success toast with count. Navigate back to topic article on completion.",
            "parentId": "undefined"
          }
        ]
      },
      {
        "id": "143",
        "title": "Notebook Redesign: Visual Design System",
        "description": "Apply consistent visual design across all Notebook screens. Warm stone colors, purple accents, proper typography scale, callout styling. Add CSS variables to theme.",
        "details": "COLOR PALETTE (add to src/index.css as CSS variables):\n--notebook-bg: #FAFAF9 (warm off-white, stone-50)\n--notebook-card: #FFFFFF\n--notebook-sidebar: #F5F5F4 (stone-100)\n--notebook-text: #1C1917 (stone-900)\n--notebook-muted: #78716C (stone-500)\n--notebook-accent: #7C3AED (purple-600)\n--notebook-pearl: #059669 (emerald-600)\n--notebook-trap: #D97706 (amber-600)\n--notebook-caution: #DC2626 (red-600)\n--notebook-board: #EFF6FF (blue-50)\n\nTYPOGRAPHY:\n- H1 (Topic title): text-3xl font-bold (28px)\n- H2 (Section): text-xl font-semibold (22px)\n- Body: text-base leading-relaxed (16px, 1.6 line-height)\n- Meta: text-sm text-muted-foreground (14px)\n- Footnote: text-xs (12px) with superscript styling\n\nCONTENT WIDTH:\n- Max: max-w-3xl (720px) for optimal readability\n- Padding: px-6 (24px horizontal)\n\nSPACING RHYTHM:\n- Section gap: space-y-12 (48px)\n- Paragraph: space-y-6 (24px)\n- Callout: my-6 with p-4 internal\n- Inline elements: gap-2 (8px)\n\nCALLOUT STYLING:\nClinical Pearl:\n- bg-emerald-50 border-l-4 border-emerald-500 rounded-r-lg p-4\n- Icon: Lightbulb (lucide-react)\n- Header: font-semibold text-emerald-800\n\nExam Trap:\n- bg-amber-50 border-l-4 border-amber-500 rounded-r-lg p-4\n- Icon: AlertTriangle (lucide-react)\n- Header: font-semibold text-amber-800\n\nCaution:\n- bg-red-50 border-l-4 border-red-500 rounded-r-lg p-4\n- Icon: AlertCircle (lucide-react)\n- Header: font-semibold text-red-800\n\nBoard Relevance Panel:\n- bg-blue-50 border border-blue-200 rounded-xl\n- Collapsible with hover:bg-blue-100 on header\n\nHOVER STATES (Things 3 / Linear inspired):\n- Topic row: Actions fade in from right on hover\n- Text paragraph: Faint edit icon appears on hover\n- Callout: Edit/delete icons appear top-right on hover\n\nTRANSITIONS:\n- transition-colors for hover states\n- transition-opacity for action buttons appearing",
        "testStrategy": "Test color variables are defined in CSS. Test typography scale is consistent. Test callout blocks have correct colors. Test Board Relevance panel has blue styling. Test hover states show actions. Test content max-width is 720px. Test spacing rhythm is consistent.",
        "priority": "medium",
        "dependencies": [],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-25T19:26:00.741Z"
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2026-01-25T21:23:25.031Z",
      "taskCount": 48,
      "completedCount": 36,
      "tags": [
        "master"
      ]
    }
  }
}